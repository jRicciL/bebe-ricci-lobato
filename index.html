<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Revelaci√≥n Beb√© Ricci Lobato</title>

<link rel="icon" type="image/png" href="favicon.png?v=2">

<!-- M√∫sica suave -->
<audio id="bgMusic" loop preload="auto">
    <source src="audio/musica_fondo.mp3" type="audio/mpeg">
</audio>

<audio id="revealSound">
    <source src="audio/reveal-sound.mp3" type="audio/mpeg">
</audio>

<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

<style>

/* =====================
   GLOBAL PAGE
===================== */
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
}

body {
    font-family: "Quicksand", sans-serif;
    background-image: url("https://images.unsplash.com/photo-1422205512921-12dac7b3b603?fm=jpg&q=60&w=3000");
    background-size: cover;
    background-position: center;
    background-attachment: fixed;

    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;

    overflow-x: hidden;
    color: #2b3a2d;
}

    h1, h2 {
    margin-top: 8px !important;
    margin-bottom: 12px !important;
    line-height: 1.15;
    text-align: center;
}

h1 {
    font-size: 32px;
    font-weight: 700;
}

h2 {
    font-size: 24px;
    font-weight: 600;
}

.glass-block {
    justify-content: flex-start;
    padding-top: 24px;
}

/* =====================
   MUSIC TOGGLE BUTTON
===================== */
#musicToggle {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 6;
    background: rgba(255,255,255,0.55);
    backdrop-filter: blur(10px);
    padding: 10px 14px;
    font-size: 24px;
    border-radius: 50%;
    cursor: pointer;
    user-select: none;
    transition: 0.3s;
    box-shadow: 0 6px 20px rgba(0,0,0,0.25);
}
#musicToggle:hover {
    transform: scale(1.12);
}

/* SELECT MATERIAL STYLE */
select {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;

    background: rgba(255,255,255,0.65);
    border: none;
    border-bottom: 3px solid #7a8f78;
    border-radius: 0;

    padding: 12px 18px;
    font-size: 18px;
    width: 80%;
    max-width: 330px;
    color: #2b3a2d;

    transition: border-color 0.3s ease;
}

/* L√≠nea inferior cambia de color al enfocar */
select:focus {
    outline: none;
    border-bottom: 3px solid #557a55; /* tono m√°s oscuro */
}

/* placeholder (opci√≥n deshabilitada) */
select option[value=""] {
    color: #7d7d7d;
}

/* Flechita personalizada */
select {
    background-image: url('data:image/svg+xml;utf8,<svg fill="%23656565" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 22px;
}

/* =====================
   PARTICLE BACKGROUND
===================== */
#particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 2;
}

.particle {
    position: absolute;
    background: rgba(255,255,255,0.7);
    border-radius: 50%;
    opacity: 0.7;
    animation: floatParticle linear infinite;
}

@keyframes floatParticle {
    from { transform: translateY(0); }
    to { transform: translateY(-120vh); }
}

/* =====================
   CONTENT BLOCKS
===================== */
.glass-block {
    background: rgba(255, 255, 255, 0.28);
    backdrop-filter: blur(13px);
    -webkit-backdrop-filter: blur(13px);
    border-radius: 22px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.18);
    padding: 30px;
    max-width: 92%;
    width: 600px;

    opacity: 0;
    transform: translateY(20px);
    transition: opacity 1.1s ease, transform 1.1s ease;
    position: relative;
    z-index: 3;

    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
}

.glass-block.show {
    opacity: 1;
    transform: translateY(0);
}

#titleBlock {
    background: rgba(255, 255, 255, 0.55);
}

.profile-pic {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    margin-top: 10px;
    margin-bottom: 20px;
    border: 4px solid rgba(255,255,255,0.7);
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    transition: opacity 0.8s ease, transform 0.8s ease;
    opacity: 0;
    transform: scale(0.85);
}

.profile-pic.show {
    opacity: 1;
    transform: scale(1);
}

.pre-reveal-img {
    width: 180px;
    max-width: 70%;
    margin: 10px 0 20px 0;
    border-radius: 18px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.18);
    opacity: 0;
    transform: scale(0.85);
    transition: opacity 0.7s ease, transform 0.7s ease;
}

.pre-reveal-img.show {
    opacity: 1;
    transform: scale(1);
}

/* =====================
   INPUTS & BUTTONS
===================== */
input, select, button {
    font-family: inherit;
    font-size: 18px;
    padding: 12px 18px;
    margin-top: 12px;
    border-radius: 14px;
    border: 2px solid #a7b9a1;
    outline: none;
    background: rgba(255,255,255,0.65);
    width: 80%;
    max-width: 330px;
}

button {
    background: #7a8f78;
    color: white;
    border: none;
    cursor: pointer;
    transition: 0.3s;
}
button:hover {
    background: #6c8069;
    transform: scale(1.05);
}

/* DATE INPUT STYLE */
input[type="date"] {
    -webkit-appearance: none;
    appearance: none;

    background: rgba(255,255,255,0.65);
    border: none;
    border-bottom: 3px solid #7a8f78;
    border-radius: 0;

    padding: 12px 18px;
    font-size: 18px;
    width: 80%;
    max-width: 330px;
    color: #2b3a2d;

    transition: border-color 0.3s ease;
}

input[type="date"]:focus {
    outline: none;
    border-bottom: 3px solid #557a55;
}

.hidden { display: none; }

/* =====================
   COUNTDOWN
===================== */
#countdown {
    font-size: 90px;
    font-weight: 700;
    color: #314631;
    animation: countPop 1s ease;
}

@keyframes countPop {
    0%   { transform: scale(0.4); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}

img.count-img {
    width: 78%;
    max-width: 360px;
    border-radius: 22px;
    margin-top: 20px;
}

/* Animaciones suaves de zoom */
.count-img {
    transition: 
        transform 0.85s cubic-bezier(0.25, 0.1, 0.25, 1),
        opacity 0.85s ease;
    will-change: transform, opacity;
}
.count-img.zooming-in {
    transform: scale(1.10);
    opacity: 1;
}

.count-img.reset {
    transform: scale(0.92);
    opacity: 0.6;
}

/* =====================
   REVEAL BACKGROUND
===================== */
#revealBackground {
    display: none;
    position: fixed;
    z-index: 0.5;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url("https://images6.alphacoders.com/662/662213.jpg");
    background-size: cover;
    background-position: center;
    opacity: 0;
    transition: opacity 2s ease;
}

#shareBtn {
    margin-top: 25px;
    padding: 10px 22px;
    font-size: 17px;
    border-radius: 18px;
    border: none;
    cursor: pointer;

    background: rgba(255,255,255,0.45);
    backdrop-filter: blur(10px);
    color: #2b3a2d;
    transition: 0.3s ease;
    box-shadow: 0 6px 25px rgba(0,0,0,0.18);
}

#shareBtn:hover {
    background: rgba(255,255,255,0.65);
    transform: scale(1.04);
}

    #revealParticles {
    position: fixed;
    pointer-events: none;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: visible;
    z-index: 2; /* encima del fondo, debajo del contenido y globos */
}

.reveal-particle {
    position: absolute;
    top: -50px;
    width: 18px;
    height: 18px;
    opacity: 0.8;
    animation: fallDown linear infinite;
    filter: blur(0.3px);
}

@keyframes fallDown {
    0% { transform: translateY(0) rotate(0deg); opacity: 0.7; }
    100% { transform: translateY(110vh) rotate(180deg); opacity: 0.4; }
}

/* =====================
   FINAL REVEAL
===================== */
#revealExtraImg {
    display: none;
    width: 75%;
    max-width: 360px;
    border-radius: 20px;
    margin-top: 10px;
    opacity: 0;
    transition: opacity 1.3s ease;
    box-shadow:0 8px 30px rgba(0,0,0,0.25);
}

#reveal-text {
    font-size: 60px;
    font-weight: 700;
    opacity: 0;
    transform: scale(0.7);
    transition: opacity 2s ease, transform 2s ease;
    color: #314631;
}

@media (max-width: 600px) {
    #reveal-text { font-size: 42px; }
    #countdown  { font-size: 70px; }
}

/* =====================
   BALLOONS
===================== */
.balloon {
    position: fixed;
    bottom: -200px;
    width: 60px;
    height: 80px;
    background: #ffd1dc;
    border-radius: 50%;
    animation: riseUp 6s ease forwards;
    z-index: 4;
}

@keyframes riseUp {
    from { transform: translateY(0); }
    to   { transform: translateY(-150vh); }
}

#customFooter {
    position: fixed;
    bottom: 12px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 18px;
    color: white;
    opacity: 0.85;
    letter-spacing: 1px;
    font-weight: 600;
    z-index: 5;
    pointer-events: none;
}

@media (max-height: 600px) {
    #customFooter {
        position: static;
        margin-top: 40px;
        transform: none;
        text-align: center;
    }
}

.screen-block {
    padding-top: 40px !important;
    padding-bottom: 40px !important;
    box-sizing: border-box;
}

/* T√≠tulos m√°s proporcionados */
/* ============================
   TITLES ‚Äî smaller & consistent
============================ */
h1, h2 {
    margin-top: 10px !important;
    margin-bottom: 10px !important;
    line-height: 1.15;
    text-align: center;
}

/* Tama√±o general mejor balanceado */
h1 {
    font-size: 28px;
    font-weight: 700;
}
h2 {
    font-size: 22px;
    font-weight: 600;
}

/* Vista m√≥vil */
@media (max-width: 600px) {
    h1 {
        font-size: 24px;
    }
    h2 {
        font-size: 20px;
    }
}

/* ============================
   UNIVERSAL BLOCK SPACING
============================ */
.screen-block {
    padding-top: 60px !important;
    padding-bottom: 50px !important;
    box-sizing: border-box;
}

/* Cuando hay pantallas muy bajas, aseguramos espacio */
@media (max-height: 650px) {
    .screen-block {
        padding-top: 40px !important;
        padding-bottom: 40px !important;
    }
}

@media (max-height: 520px) {
    .screen-block {
        padding-top: 30px !important;
        padding-bottom: 30px !important;
    }
}

/* ============================
   PREVENT TITLE FROM CLIPPING
============================ */
#titleBlock {
    margin-top: 25px !important;
    margin-bottom: 20px !important;
    padding-top: 20px !important;
}

</style>
</head>
<body>

<!-- Music Toggle -->
<div id="musicToggle" onclick="toggleMusic()">üîä</div>


<!-- Final Reveal Background -->
<div id="revealBackground"></div>
<!-- Particle layer -->
<div id="particles"></div>
<div id="revealParticles"></div>

<!-- MAIN CONTENT -->
<h1 class="glass-block screen-block show" id="titleBlock">‚ú®üíõüß°‚ô•Ô∏è Beb√© Ricci Lobato ‚ô•Ô∏èüß°üíõ‚ú®</h1>

<div id="landing" class="glass-block screen-block show">
    <p>Escribe tu nombre para comenzar:</p>
    <input id="nameInput" placeholder="Tu nombre..." />
    <br>
    <button onclick="validateName()">Entrar</button>
    <p id="nameError" style="color:#5b2b2b;"></p>
</div>

<div id="questions" class="glass-block screen-block hidden">
    <h2 id="welcomeText"></h2>
    <!-- <p>¬øCu√°l es el a√±o de nacimiento de beb√©?</p>
    <input id="yearInput" placeholder="Ejemplo: 2026" /> -->

    <img id="profilePic" class="profile-pic hidden" src="">

    <p id="genderQuestionText" style="margin-top:20px;"></p>

    <select id="guessInput">
        <option value="" disabled selected>Selecciona una opci√≥n‚Ä¶</option>
        <option value="ni√±o">Ni√±o</option>
        <option value="ni√±a">Ni√±a</option>
    </select>

    <p style="margin-top:20px;">¬øCu√°l crees que ser√° la fecha de mi nacimiento?</p>

    <input 
        type="date" 
        id="birthDateInput" 
        value="2026-04-15"
    />

    <p style="margin-top:20px;">¬øQui√©n crees que va a cambiar m√°s pa√±ales?</p>

    <select id="diaperInput">
        <option value="" disabled selected>Selecciona una opci√≥n‚Ä¶</option>
        <option value="Joel üôÉ">Joel</option>
        <option value="Jackie ‚ù§Ô∏è">Jackie</option>
        <option value="Turno mixto ü§üüèΩ">Turno mixto</option>
        <option value="El abuelito Neto üòè">Los t√≠os y abuelitos üòè</option>
    </select>

    <button onclick="submitQuestions()" style="margin-top:20px">Continuar</button>
    <p id="qError" style="color:#5b2b2b;"></p>
</div>

<div id="preCountMessage" class="glass-block hidden">
    <h2 id="preCountText"></h2>

    <!-- Imagen entre las frases -->
    <img id="preRevealImg" class="pre-reveal-img hidden" src="">

    <button onclick="startCountdown()">Continuar</button>
</div>

<div id="countContainer" class="glass-block hidden">
    <div id="countdown"></div>
    <img id="countImg" class="count-img" src="">
</div>

<div id="reveal" class="glass-block hidden">
    <h2 id="revealFinalText"></h2>

    <!-- Imagen adicional antes del texto final -->
    <img id="revealExtraImg" src="img/a_girl.jpg">

    <h1 id="reveal-text">üíó ¬°Soy una ni√±a! üíó</h1>
    <button id="shareBtn" onclick="sendResultsToWhatsApp()">Compartir mis respuestas con Jackie y Joel üí¨</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>

const expectedBirthDate = "2026-04-15"; 

function sendResultsToWhatsApp() {
    // N√∫mero de destino (usa el tuyo)
    const number = "529541011419"; // ‚Üê PON AQU√ç EL N√öMERO DE JACKIE O TUYO

    const prettyDate = guessedBirthDate
        ? formatPrettyDate(guessedBirthDate)
        : "No especificada";

    const msg =
        `Revelaci√≥n Beb√© Ricci Lobato üíñüë©üèª‚Äçüçºüåø

        Nombre: ${currentName}

        Predicci√≥n del g√©nero: ${guessGender}
        Predicci√≥n de fecha de nacimiento: ${prettyDate}
        Predicci√≥n de qui√©n cambiar√° m√°s pa√±ales: ${diaperPrediction}

        ¬°Ya particip√© en la revelaci√≥n! üíõ‚ú®`;

            const url = "https://api.whatsapp.com/send?phone=&text=" 
                        + encodeURIComponent(msg)
                        + "&group_id=" + number;

            window.open(url, "_blank");
}

/* =====================
   MUSIC TOGGLE
===================== */
let musicEnabled = true;

function toggleMusic() {
    const m = document.getElementById("bgMusic");
    const btn = document.getElementById("musicToggle");

    if (musicEnabled) {
        m.pause();
        btn.textContent = "üîá";
    } else {
        m.play().catch(()=>{});
        btn.textContent = "üîä";
    }

    musicEnabled = !musicEnabled;
}

/* =====================
   PARTICLES
===================== */
function createParticles() {
    const container = document.getElementById("particles");
    for (let i = 0; i < 30; i++) {
        const p = document.createElement("div");
        p.classList.add("particle");
        p.style.width = p.style.height = (Math.random() * 10 + 4) + "px";
        p.style.left = Math.random() * 100 + "%";
        p.style.animationDuration = (6 + Math.random()*6) + "s";
        p.style.animationDelay = (-Math.random()*6) + "s";
        container.appendChild(p);
    }
}
createParticles();

/* =====================
   BALLOONS
===================== */
function launchBalloons() {
    for (let i = 0; i < 12; i++) {
        const b = document.createElement("div");
        b.classList.add("balloon");

        const colors = ["#ffd1dc","#ffb7ce","#ffc4dd","#ffd8e5","#ffccda"];
        b.style.background = colors[i % colors.length];

        b.style.left = Math.random() * 80 + 10 + "%";
        b.style.animationDuration = (5 + Math.random()*4)+"s";

        document.body.appendChild(b);
        setTimeout(() => b.remove(), 9000);
    }
}

function launchRevealParticles() {
    const container = document.getElementById("revealParticles");

    for (let i = 0; i < 25; i++) {
        const p = document.createElement("div");
        p.classList.add("reveal-particle");

        // elegir si ser√°: p√©talo, hojita, copito o coraz√≥n
        const options = ["üå∏","‚ùÑÔ∏è","üçÉ","üíû"];
        const emoji = options[Math.floor(Math.random() * options.length)];

        p.textContent = emoji;

        // posici√≥n inicial
        p.style.left = Math.random() * 100 + "%";

        // duraci√≥n de ca√≠da (5‚Äì10s)
        p.style.animationDuration = (5 + Math.random() * 5) + "s";

        // tama√±o random
        p.style.fontSize = (16 + Math.random() * 10) + "px";

        container.appendChild(p);

        // borrar part√≠cula cuando termine
        setTimeout(() => p.remove(), 12000);
    }

    // repetir cada 800ms para mantener flujo suave
    setTimeout(launchRevealParticles, 800);
}

/* =====================
   PEOPLE MAP
===================== */
const peopleMap = {
    // --- Grupo original ya validado ---
    "joel": ["Joel", "üíô"],
    "joel ricci": ["Joel", "üíô"],
    "joel ricci lopez": ["Joel", "üíô"],

    "jackie": ["Jackie", "üíñ"],
    "jacky": ["Jackie", "üíñ"],
    "gladys lobato": ["Jackie", "üíñ"],
    "gladys jaqueline lobato": ["Jackie", "üíñ"],
    "jackie lobato": ["Jackie", "üíñ"],

    "oscar r": ["Oscar", "üíôüòé"],
    "oscar ricci": ["Oscar", "üíôüòé"],
    "oscar de jesus ricci lopez": ["Oscar", "üíôüòé"],

    "liz": ["Liz", "üå∑"],
    "liz lopez": ["Liz", "üå∑"],
    "liz lopez mesinas": ["Liz", "üå∑"],
    "bacilisa": ["Liz", "üå∑"],

    "tere": ["Tere", "üåº"],
    "teresa": ["Tere", "üåº"],
    "teresa mesinas lopez": ["Tere", "üåº"],

    "gladys": ["Gladys", "üå∏"],
    "gladys ojeda": ["Gladys", "üå∏"],
    "gladys rosario ojeda manzano": ["Gladys", "üå∏"],

    "rosy": ["Rosy y familia", "üå∏"],
    "rosalia": ["Rosy y familia", "üå∏"],
    "rosal√≠a ojeda": ["Rosy y familia", "üå∏"],
    "rosal√≠a": ["Rosy y familia", "üå∏"],
    "rosalia ojeda": ["Rosy y familia", "üå∏"],

    "ivonne": ["Ivonne y familia", "üåπ"],
    "ivonne ojeda": ["Ivonne y familia", "üåπ"],

    "astrid": ["Astrid", "ü©∑"],
    "astir": ["Astrid", "ü©∑"],

    "jessy": ["Jessy", "üå∏"],
    "jessica": ["Jessy", "üå∏"],
    "jessy lobato": ["Jessy", "üå∏"],

    "kevin": ["Kevin", "‚ú®"],
    "kevin lazaro": ["Kevin", "‚ú®"],
    "kevin l√°zaro": ["Kevin", "‚ú®"],

    "alfonso": ["Alfonso", "‚öΩ"],
    "poncho": ["Alfonso", "‚öΩ"],
    "alfonso lobato": ["Alfonso", "‚öΩ"],

    "martin": ["Mart√≠n", "üê∫"],
    "mart√≠n": ["Mart√≠n", "üê∫"],

    "antonita": ["To√±ita", "üå∑"],
    "to√±ita": ["To√±ita", "üå∑"],
    "antonia salazar": ["To√±ita", "üå∑"],

    // --- Nuevos nombres a√±adidos ---

    // Kiki
    "kiki": ["Kiki", "üå∏"],
    "kiki lobato": ["Kiki", "üå∏"],
    "ana kristian lobato": ["Kiki", "üå∏"],
    "ana khristian": ["Kiki", "üå∏"],
    "khristian lobato": ["Kiki", "üå∏"],

    // Ithma
    "ithma": ["Ithma", "üå∏"],
    "ithma diaz de leon": ["Ithma", "üå∏"],
    "ithma d√≠az de le√≥n": ["Ithma", "üå∏"],

    // Giova
    "giovanni": ["Giova", "üòé"],
    "giova": ["Giova", "üòé"],
    "giovanny": ["Giova", "üòé"],
    "giovanni lobato": ["Giova", "üòé"],
    "giovanny lobato": ["Giova", "üòé"],

    // Khristen
    "khristen": ["Khristen", "üå∑"],
    "khristen lobato": ["Khristen", "üå∑"],
    "khristen lobato diaz de leon": ["Khristen", "üå∑"],

    // Pris y Poncho
    "priscila y alfonso": ["Pris y Poncho", "üå∑"],
    "pris y poncho": ["Pris y Poncho", "üå∑"],
    "priscila y alfonso lobato": ["Pris y Poncho", "üå∑"],
    "pris y poncho lobato": ["Pris y Poncho", "üå∑"],

    // Oscar (otro Oscar Lobato)
    "oscar": ["Oscar Lobato", "üòé"],
    "oscar lobato": ["Oscar Lobato", "üòé"],
    "oscarin lobato": ["Oscar Lobato", "üòé"],
    "√≥scar lobato": ["Oscar Lobato", "üòé"],

    // Alvarito
    "alvaro": ["Alvarito", "üòé"],
    "√°lvaro": ["Alvarito", "üòé"],
    "alvaro mejia": ["Alvarito", "üòé"],
    "alvaro mejia ojeda": ["Alvarito", "üòé"],
    "alvaro mej√≠a ojeda": ["Alvarito", "üòé"],
    "√°lvaro mej√≠a ojeda": ["Alvarito", "üòé"],

    // Alma
    "alma": ["Alma", "üå∏"],
    "alma romero": ["Alma", "üå∏"],
    "alma romero ojeda": ["Alma", "üå∏"],
    "bibi": ["Alma", "üå∏"],

    // Gina
    "gina": ["Gina", "üå∏"],
    "giorgi": ["Gina", "üå∏"],
    "georgina": ["Gina", "üå∏"],
    "georgina romero": ["Gina", "üå∏"],
    "georgina romero ojeda": ["Gina", "üå∏"],

    // Gina
    "ana espino": ["Ana", "üå∏"],
    "ana": ["Ana", "üå∏"],
    "anna": ["Ana", "üå∏"],
    "anna espino": ["Ana", "üå∏"],

    // Charlie
    "charlie": ["Charlie", "üòé"],
    "charly": ["Charlie", "üòé"],
    "carlos": ["Charlie", "üòé"],
    "carlitos": ["Charlie", "üòé"],
    "carlos granados": ["Charlie", "üòé"],
    "carlos granados mendez": ["Charlie", "üòé"],
    "carlos granados m√©ndez": ["Charlie", "üòé"],

    // Karen
    "karen": ["Karen", "üå∏"],
    "flor karen": ["Karen", "üå∏"],
    "karen granados": ["Karen", "üå∏"],
    "karen granados mendez": ["Karen", "üå∏"],
    "karen granados m√©ndez": ["Karen", "üå∏"],

    // Mariajo (y moni)
    "mariajo": ["Majo y Moni", "üå∏"],
    "mariajo y Moni": ["Majo y Moni", "üå∏"],
    "majo": ["Majo y Moni", "üå∏"],
    "majo y moni": ["Majo y Moni", "üå∏"],
    "moni y majo": ["Majo y Moni", "üå∏"],
    "maria jose": ["Majo y Moni", "üå∏"],
    "maria jos√©": ["Majo y Moni", "üå∏"],

    // Flor (Elba)
    "elba": ["Flor", "üå∏"],
    "flor": ["Flor", "üå∏"],
    "elba mendez manzano": ["Flor", "üå∏"],
    "elba alicia": ["Flor", "üå∏"],
};

const roles = {
    "Joel": "pap√°",
    "Jackie": "mam√°",

    "Liz": "abuelita",
    "Tere": "abuelita",
    "Gladys": "abuelita",
    "Ernesto": "abuelito",

    "Oscar": "t√≠o",
    "Oscar Lobato": "t√≠o",
    "Chris": "t√≠o",
    "Kevin": "t√≠o",
    "Alfonso": "t√≠o",
    "Mart√≠n": "t√≠o",
    "Giova": "t√≠o",
    "Charlie": "t√≠o",
    "Alvarito": "t√≠o",

    "Rosy y familia": "t√≠a",
    "Ivonne y familia": "t√≠a",
    "Majo y Moni": "t√≠as",
    "Ana": "t√≠a",
    "Jessy": "t√≠a",
    "To√±ita": "t√≠a",
    "Kiki": "t√≠a",
    "Ithma": "t√≠a",
    "Alma": "t√≠a",
    "Gina": "t√≠a",
    "Karen": "t√≠a",
    "Flor": "t√≠a",

    "Pris y Poncho": "t√≠os",

    "Khristen": "primita"
};

const profilePics = {
    "Joel": "img/joel.jpg",
    "Jackie": "img/jackie.jpg",

    "Liz": "img/liz.jpg",
    "Tere": "img/tere.jpg",
    "Gladys": "img/gladys.jpg",
    "Ernesto": "img/ernesto.jpg",

    "Oscar": "img/oscar.jpg",
    "Oscar Lobato": "img/oscar_lobato.jpg",
    "Chris": "img/chris.jpg",
    "Kevin": "img/kevin.jpg",
    "Alfonso": "img/alfonso.jpg",
    "Mart√≠n": "img/martin.jpg",
    "Giova": "img/giova.jpg",
    "Charlie": "img/charlie.jpg",
    "Alvarito": "img/alvarito.jpg",

    "Rosy y familia": "img/rosy.jpg",
    "Ivonne y familia": "img/ivonne.jpg",
    "Majo y Moni": "img/majo.jpg",
    "Jessy": "img/jessy.jpg",
    "To√±ita": "img/tonita.jpg",
    "Kiki": "img/kiki.jpg",
    "Ithma": "img/ithma.jpg",
    "Alma": "img/alma.jpg",
    "Ana": "img/ana.jpg",
    "Gina": "img/alma.jpg",
    "Karen": "img/karen.jpg",
    "Flor": "img/flor.jpg",

    "Khristen": "img/khristen.jpg",
    "Pris y Poncho": "img/pris_y_poncho.jpg"
};

const imageVariantByPerson = {
    // --- Variantes originales que pediste preservar ---
    "Joel": "b",
    "Jackie": "a",
    "Oscar": "b",
    "Liz": "b",
    "Tere": "b",
    "Gladys": "a",
    "Ernesto": "c",
    "Chris": "a",
    "Rosy y familia": "a",
    "Ivonne y familia": "a",
    "Majo y Moni": "a",
    "Astrid": "a",
    "Jessy": "c",
    "Kevin": "c",
    "Alfonso": "c",
    "To√±ita": "c",
    "Mart√≠n": "c",

    // --- Variantes nuevas (todas = "c") ---
    "Kiki": "c",
    "Ithma": "c",
    "Giova": "c",
    "Khristen": "c",
    "Pris y Poncho": "c",
    "Oscar Lobato": "c",
    "Alvarito": "a",
    "Alma": "a",
    "Gina": "a",
    "Charlie": "a",
    "Karen": "a",
    "Flor": "a"
};

function normalize(s) { return s.trim().toLowerCase(); }

function formatPrettyDate(dateStr) {
    return new Date(dateStr).toLocaleDateString("es-MX", {
        day: "2-digit",
        month: "long",
        year: "numeric"
    });
}

function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
}

function getPersonInfo(inputName) {
    const name = normalize(inputName);
    
    // 1. Obtenemos todas las claves (nombres en la lista)
    const keys = Object.keys(peopleMap);

    // 2. Las ordenamos por longitud: de la M√ÅS LARGA a la m√°s corta.
    // Esto asegura que "Pris y Poncho" se verifique antes que "Poncho".
    keys.sort((a, b) => b.length - a.length);

    for (const key of keys) {
        if (name.includes(key)) return peopleMap[key];
    }
    return null;
}

function buildGreeting(name, emoji) {
    const role = roles[name] || "";
    return `${emoji} ¬°Hola, ${capitalize(role)} ${name}! ${emoji}`;
}

function getCountdownImage(num) {

    // Para 12 al 4 usamos variantes: a, b o c
    if (num <= 12 && num >= 4) {
        return `img/${num}-${currentVariant}.jpg`;
    }

    // Para los dem√°s (19‚Äì8 y 3‚Äì1)
    return `img/${num}.jpg`;
}

function getDelayForNumber(num) {
    // Normal (19 ‚Üí 6)
    if (num == 19) return 1600; 
    if (num > 7) return 1300; // 1 segundo

    // Incremental (5 ‚Üí 2)
    const customDelays = {
        7: 1300,
        6: 1350,
        5: 1550,
        4: 1800,
        3: 1900,
        2: 2100
    };

    if (customDelays[num]) return customDelays[num];

    // √öltimo segundo (1)
    if (num === 1) return 2400;

    return 1200; // default fallback
}

/* =====================
   VALIDATE NAME
===================== */
let currentGreeting = "";
let guessGender = null;
let guessedBirthDate = null;
let diaperPrediction = null;
let currentVariant = "a";
let isPlural = false;

function playMusic() {
    const m = document.getElementById("bgMusic");
    m.volume = 0.4;
    m.play().catch(()=>{});
}

function fadeSwap(hideId, showId) {
    const hide = document.getElementById(hideId);
    const show = document.getElementById(showId);

    hide.classList.remove("show");
    setTimeout(() => {
        hide.classList.add("hidden");
        show.classList.remove("hidden");
        setTimeout(() => show.classList.add("show"), 20);
    }, 600);
}

function validateName() {
    playMusic();

    const input = document.getElementById("nameInput").value;
    const err = document.getElementById("nameError");

    const info = getPersonInfo(input);

    if (!info) {
        err.innerHTML = "No encontr√© tu nombre en la lista üôà<br>¬øEst√° bien escrito?";
        return;
    }

    const [personName, emoji] = info;

    currentName = personName;
    currentEmoji = emoji;
    currentRole = roles[personName] || "";
    currentVariant = imageVariantByPerson[personName] || "a";

    // --- DETECCI√ìN DE PLURAL ---
    // Si el nombre incluye " y " (con espacios), asumimos que son dos personas
    isPlural = currentName.toLowerCase().includes(" y ") || currentRole.trim().toLowerCase().endsWith("s"); 

    currentGreeting = buildGreeting(personName, emoji);

    document.getElementById("titleBlock").style.display = "none";

    fadeSwap("landing","questions");

    document.getElementById("welcomeText").innerHTML = currentGreeting;

    // --- L√ìGICA DE TEXTO DIN√ÅMICO ---
    const genderQ = document.getElementById("genderQuestionText");
    
    if (isPlural) {
        // Versi√≥n Plural
        genderQ.innerHTML = `D√≠ganme ${currentRole}‚Ä¶ ¬øCreen que soy ni√±o o ni√±a?`;
    } else {
        // Versi√≥n Singular
        genderQ.innerHTML = `Dime ${currentRole}‚Ä¶ ¬øCrees que soy ni√±o o ni√±a?`;
    }

    // Cargar foto de perfil correspondiente
    const pic = profilePics[personName];

    if (pic) {
        const img = document.getElementById("profilePic");
        img.src = pic;
        img.classList.remove("hidden");

        // aseguramos animaci√≥n
        setTimeout(() => img.classList.add("show"), 50);
    };
    
    // (Opcional) Actualizar las otras preguntas est√°ticas al plural
    if (isPlural) {
       // Buscamos los textos en el HTML y los cambiamos solo si es plural
       // Nota: Esto busca por contenido de texto aproximado en el bloque de preguntas
       const labels = document.getElementById("questions").getElementsByTagName("p");
       for(let p of labels) {
           if(p.innerText.includes("crees que ser√°")) p.innerText = "¬øCu√°l creen que ser√° la fecha de mi nacimiento?";
           if(p.innerText.includes("crees que va")) p.innerText = "¬øQui√©n creen que va a cambiar m√°s pa√±ales?";
       }
    }
}

/* =====================
   QUESTIONS
===================== */
function submitQuestions() {
    // const year = document.getElementById("yearInput").value.trim();
    const guessSelect = document.getElementById("guessInput");
    const guess = guessSelect.value;
    const birthDate = document.getElementById("birthDateInput").value;
    guessedBirthDate = birthDate;
    const err = document.getElementById("qError");

    // Validar a√±o
    // if (year !== "2026") {
    //     err.textContent = "El a√±o de nacimiento no es correcto üòÖ";
    //     return;
    // }

    // ‚ùó Evitar continuar sin elegir ni√±o/ni√±a
    if (!guess) {
        err.textContent = "Por favor elige si crees que soy ni√±o o ni√±a üòä";
        return;
    }

    if (!birthDate) {
        err.textContent = "Por favor elige una fecha de nacimiento estimada üìÖ";
        return;
    }

    diaperPrediction = document.getElementById("diaperInput").value;

    if (!diaperPrediction) {
        err.textContent = "¬øY qui√©n va a cambiar m√°s pa√±ales? üòÜ ¬°Elige una opci√≥n!";
        return;
    }


    // Guardar valor normalizado
    guessGender = guess.trim().toLowerCase();
    const genderEmoji = guessGender === "ni√±a" ? "üéÄ" : "ü©µ";

    // Validar si est√° dentro de ¬±40 d√≠as
    const chosen = new Date(birthDate);
    const expected = new Date(expectedBirthDate);

    const diffMs = chosen - expected; // puede ser + o -
    const diffDays = Math.abs(diffMs) / (1000 * 60 * 60 * 24);

    // Si est√° fuera del rango permitido
    if (diffDays > 40) {

        let funnyMsg = "";

        const isGirl = guessGender === "ni√±a";
        const babyEmoji = isGirl ? "üë∂üéÄ" : "üë∂ü©µ";

        if (diffMs < 0) {
            // Eligi√≥ una fecha demasiado TEMPRANA
            funnyMsg = isGirl
                ? `¬°Tan pronto no llega nuestra nena! ${babyEmoji}`
                : `¬°Nuestro beb√© no es tan r√°pido! ${babyEmoji}`;
        } else {
            // Eligi√≥ una fecha demasiado TARDE
            funnyMsg = isGirl
                ? `¬°Nuestra nena no se va a tardar taaanto! üòÑ ${babyEmoji}`
                : `¬°Ese campe√≥n no se va a hacer del rogar tanto! üòÜ ${babyEmoji}`;
        }

        err.textContent = funnyMsg;
        return;
    }

    document.getElementById("preCountText").innerHTML = `
    As√≠ que <strong>${guessGender} ${genderEmoji}</strong> eh...
    <br>

    <img src="img/bebe-ricci-lobato1.jpg" 
         style="width:320px; max-width:70%; margin:12px 0 18px 0; border-radius:16px; box-shadow:0 8px 30px rgba(0,0,0,0.18);" 
    />

    <br>¬°Prep√°rate para la gran sorpresa! üôâ
    `;

    fadeSwap("questions","preCountMessage");
}

/* =====================
   COUNTDOWN
===================== */
const images = [
    "https://placekitten.com/300/300",
    "https://placekitten.com/300/301",
    "https://placekitten.com/300/302",
    "https://placekitten.com/300/303",
    "https://placekitten.com/300/304",
    "https://placekitten.com/300/305",
    "https://placekitten.com/300/306",
    "https://placekitten.com/300/307",
    "https://placekitten.com/300/308",
    "https://placekitten.com/300/309"
];

function preloadCountdownImages() {
    // Pre-carga para evitar ‚Äúparpadeos‚Äù o retrasos
    const cache = [];
    for (let n = 1; n <= 19; n++) {
        const img = new Image();
        img.src = getCountdownImage(n);
        cache.push(img);
    }
}

function startCountdown() {
    fadeSwap("preCountMessage", "countContainer");

    let count = 19;

    const countdown = document.getElementById("countdown");
    const img = document.getElementById("countImg");

    function runStep() {

        // mostrar n√∫mero
        countdown.textContent = count;

        // reset visual de la imagen antes de cambiarla
        img.classList.remove("zooming-in");
        img.classList.add("reset");

        // esperando un breve instante para que el reset aplique
        setTimeout(() => {
            img.src = getCountdownImage(count);

            // ahora s√≠ aplicar el zoom in suave
            requestAnimationFrame(() => {
                img.classList.remove("reset");
                img.classList.add("zooming-in");
            });
        }, 120);

        // si llegamos a 1 ‚Üí revelaci√≥n final
        if (count === 1) {
            setTimeout(showReveal, getDelayForNumber(1));
            return;
        }

        const delay = getDelayForNumber(count);
        count--;

        setTimeout(runStep, delay);
    }

    runStep();
}

/* =====================
   FINAL REVEAL
===================== */
function showReveal() {

    const bg = document.getElementById("revealBackground");
    bg.style.display = "block";
    setTimeout(() => bg.style.opacity = 1, 50);

    fadeSwap("countContainer","reveal");

    // Determinar si adivin√≥ que era ni√±a
    const guessedCorrectly = (guessGender && guessGender.toLowerCase() === "ni√±a");

    // Mensaje divertido si s√≠ adivin√≥ (ADAPTADO A PLURAL)
    let surpriseText = "";
    if (guessedCorrectly) {
        surpriseText = isPlural ? "¬°¬øC√≥mo supieron?!" : "¬°¬øC√≥mo supiste?!";
    }

    // Mostrar el texto final bonito
    document.getElementById("revealFinalText").innerHTML =
        `${capitalize(currentRole)} ${currentName} ${currentEmoji}... ${surpriseText}`;

    const extra = document.getElementById("revealExtraImg");
    extra.style.display = "block";

    setTimeout(() => {
        extra.style.opacity = 1;
    }, 200);


    setTimeout(() => {
        // Reproducir sonido bonito de revelaci√≥n
        const rs = document.getElementById("revealSound");
        rs.currentTime = 0; // por si acaso
        rs.play().catch(()=>{});

        const t = document.getElementById("reveal-text");
        t.style.opacity = 1;
        t.style.transform = "scale(1)";
    }, 900);

    confetti({
        particleCount: 350,
        spread: 90,
        origin: { y: 0.6 }
    });

    launchBalloons();
    launchRevealParticles();
}

document.addEventListener("keydown", function(e) {
    if (e.key === "Enter") {

        // Pantalla 1: Nombre
        if (!document.getElementById("landing").classList.contains("hidden")) {
            validateName();
            return;
        }

        // Pantalla 2: Preguntas
        if (!document.getElementById("questions").classList.contains("hidden")) {
            submitQuestions();
            return;
        }

        // Pantalla 3: Mensaje antes del conteo
        if (!document.getElementById("preCountMessage").classList.contains("hidden")) {
            startCountdown();
            return;
        }

    }
});
</script>

<footer id="customFooter">Beb√© Ricci-Lobato</footer>
</body>
</html>
